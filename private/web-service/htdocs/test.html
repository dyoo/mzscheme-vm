<html>
<head>
    <script type="text/javascript" src="/easyXDM.min.js"></script>
    <script type="text/javascript">
      easyXDM.DomHelper.requiresJSON("/json2.js");
    </script>

    <script>
    var rpc = new easyXDM.Rpc(
	{ remote: "provider.html" },
	{
	    local: {compile : function(version, isModule, name, lang, text) {}},
	    remote: { compile : {}}});


    var doCompilation = function(isModule) {
        var lang = isModule ? 'wescheme' : 'wescheme-interaction';
        rpc.compile('1',
                    isModule,
                    'my program',
                    lang,
                    document.getElementById("textarea").value,
                    function(response) {
                         var transcript = document.getElementById("transcript");
                         transcript.appendChild(document.createTextNode(document.getElementById("textarea").value));
                         transcript.appendChild(document.createElement("br"));
                         transcript.appendChild(document.createTextNode(String(response.code)));
                         transcript.appendChild(document.createElement("hr"));
                    },
                    function(error) {
                         alert(error.message);
                    });

    };
    </script>


<body>



<div>
<textarea id="textarea" rows="20" cols="80">
(printf "Hello world!\n")
</textarea>
<br/>
<input type="button" value="compile as module definition" onclick="doCompilation(true)">
<input type="button" value="compile as interaction" onclick="doCompilation(false)">
</div>

<div id="transcript"></div>
</body>
</html>
